<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대전대 식단 생성기</title>
    <style>
        /* 기존 스타일 유지 */
        .tbl_st {
            position: relative;
            width: 100%;
            margin: 5px 0 0 -1px;
            font-size: 14px;
            text-align: center;
            border-top: 1px solid #b7b7b7;
            -webkit-overflow-scrolling: touch;
        }

        .tbl_st thead th {
            padding: 13px 8px;
            vertical-align: middle;
            color: #222;
            font-family: "NotoM";
            font-weight: normal;
            border-bottom: 1px solid #c7c7c7;
            border-left: 1px solid #c7c7c7;
            background: #e2e5e9;
        }

        .tbl_st tbody th {
            padding: 13px 8px;
            vertical-align: middle;
            color: #222;
            font-family: "NotoM";
            font-weight: normal;
            border-bottom: 1px solid #c7c7c7;
            border-left: 1px solid #c7c7c7;
            background: #f7f7f7;
        }

        .tbl_st td {
            padding: 10px 8px;
            border-bottom: 1px solid #c7c7c7;
            border-left: 1px solid #c7c7c7;
        }

        .tbl_st tfoot th {
            padding: 13px 8px;
            color: #222;
            font-family: "NotoM";
            font-weight: normal;
            border-bottom: 1px solid #c7c7c7;
            border-left: 1px solid #c7c7c7;
            background: #f7f7f7;
        }

        .tbl_st tfoot td {
            padding: 13px 8px;
            vertical-align: middle;
            border-bottom: 1px solid #c7c7c7;
            border-left: 1px solid #c7c7c7;
            background: #f7f7f7;
        }

        .tbl_st:after {
            content: "";
            display: block;
            position: absolute;
            left: 0;
            top: 0;
            width: 1px;
            height: 100%;
            clear: both;
            overflow: hidden;
            background: #fff;
        }

        /* textarea 스타일 추가 */
        .tbl_st textarea {
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            border: none;
            padding: 0;
            margin: 0;
            resize: none; /* 크기 조절 비활성화 */
            font-size: 14px; /* 테이블 폰트 사이즈와 동일하게 */
            font-family: inherit; /* 부모 요소 폰트 상속 */
            vertical-align: top; /* 텍스트 상단 정렬 */
        }

        /* 입력 필드 스타일 */
        .tbl_st input[type="text"] {
            width: 100%;
            box-sizing: border-box;
            border: none;
            padding: 0;
            margin: 0;
            font-size: 14px;
            font-family: inherit;
            text-align: center; /* 날짜 입력 중앙 정렬 */
        }

        /* 제목 입력 필드 스타일 */
        #tableTitle {
            width: auto;
            border: none;
            font-size: 18px;
            font-weight: bold;
        }

        /* 버튼 간격 */
        button {
            margin-right: 5px;
        }

        /* 복사할 HTML에만 적용될 스타일 (인라인 스타일 대체) */
        /* 구분 열 스타일 */
        .output-table thead th:first-child,
        .output-table tbody th {
            font-weight: bold; /* 구분, 조식, 중식 등 굵게 */
        }

         /* 날짜 열 스타일 */
         .output-table thead th:not(:first-child) {
            font-weight: bold; /* 날짜 열 굵게 */
         }

        /* 행 높이 스타일 */
        .output-table tr {
            height: 150px;
        }
    </style>
</head>

<body>
    <div>
        <button type="button" onclick="addCol()">열 추가</button>
        <button type="button" onclick="removeCol()">열 제거</button>
        <button type="button" onclick="copyTableHTML()">테이블 HTML 복사</button>
    </div>
    <div>
        <h4 class="tit2">
            <input type="text" id="tableTitle" placeholder="제목">
        </h4>
        <div class="tbl_st scroll_gr mgt10">
            <table id="mealTable">
                <caption></caption>
                <thead>
                    <tr id="hdTr">
                        <th>구분</th>
                        <!-- 날짜 열은 JavaScript로 추가됩니다 -->
                    </tr>
                </thead>
                <tbody>
                    <tr id="bdyTr1">
                        <th>조식</th>
                        <!-- 식단 내용은 JavaScript로 추가되는 td 내 textarea에 입력 -->
                    </tr>
                    <tr id="bdyTr2">
                        <th>중식</th>
                        <!-- 식단 내용은 JavaScript로 추가되는 td 내 textarea에 입력 -->
                    </tr>
                    <tr id="bdyTr3">
                        <th>[Extras Bar]</th>
                        <!-- 식단 내용은 JavaScript로 추가되는 td 내 textarea에 입력 -->
                    </tr>
                    <tr id="bdyTr4">
                        <th>석식</th>
                        <!-- 식단 내용은 JavaScript로 추가되는 td 내 textarea에 입력 -->
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // getTemplate 함수는 현재 사용되지 않지만, 원하시는 결과물의 형태를 참고하기 위해 남겨두었습니다.
        function getTemplate() {
            return `<div>
        <h4 class="tit2">혜화문화관</h4>
        <div class="tbl_st scroll_gr mgt10">
            <table>
                <caption></caption>
                <thead>
                    <tr>
                        <th style="font-weight: bold; ">구분</th>
                        <th style="font-weight: bold; ">2025.04.30.</th>
                        <th style="font-weight: bold; ">2025.05.01.</th>
                        <th style="font-weight: bold; ">2025.05.02.</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="height: 150px;">
                        <th>조식</th>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    <tr style="height: 150px;">
                        <th>중식</th>
                        <td>후리가케밥<br>한그릇유부우동<br>오리엔탈돈까스&amp;소스<br>볼어묵떡마라볶음<br>포기김치</td>
                        <td>참치김치밥버거<br>우동국물<br>떡볶이<br>김말이&amp;어묵튀김<br>단무지<br>배추김치</td>
                        <td>중화풍잡채<br>백미밥*잡곡밥<br>들기름미역국<br>목살김치볶음<br>콩나물무침<br>양파장아지<br>깍두기</td>
                    </tr>
                    <tr style="height: 150px;">
                        <th>[Extras Bar]</th>
                        <td>후식과자<br>후식샐러드<br>셀프계란후라이</td>
                        <td>식빵&amp;딸기잼<br>계란후라이<br>청포도에이드</td>
                        <td>식빵&amp;딸기잼<br>계란후라이<br>양배추샐러드<br>크림스프</td>
                    </tr>
                    <tr style="height: 150px;">
                        <th>석식</th>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>`;
        }

        // 열 추가 함수
        function addCol() {
            const headRow = document.querySelector('#hdTr');
            const bodyRows = document.querySelectorAll('#mealTable tbody tr');

            // 헤더에 날짜 입력 필드가 있는 th 추가
            const newHeaderTh = document.createElement('th');
            // newHeaderTh.style.fontWeight = 'bold'; // CSS 클래스로 대체
            const dateInput = document.createElement('input');
            dateInput.type = 'text';
            dateInput.placeholder = '날짜 입력'; // 예: 2025.04.30.
            newHeaderTh.appendChild(dateInput);
            headRow.appendChild(newHeaderTh);

            // 각 바디 행에 식단 내용 입력 textarea가 있는 td 추가
            bodyRows.forEach(row => {
                const newBodyTd = document.createElement('td');
                const mealTextarea = document.createElement('textarea');
                mealTextarea.placeholder = '식단 내용 입력\n(줄바꿈은 엔터)'; // 예: 메뉴1<br>메뉴2
                newBodyTd.appendChild(mealTextarea);
                row.appendChild(newBodyTd);
            });
        }

        // 열 제거 함수
        function removeCol() {
            const headRow = document.querySelector('#hdTr');
            const bodyRows = document.querySelectorAll('#mealTable tbody tr');

            // 첫 번째 '구분' 열을 제외하고 열이 있는지 확인
            if (headRow.children.length > 1) {
                // 헤더의 마지막 열 제거
                headRow.removeChild(headRow.lastChild);

                // 각 바디 행의 마지막 열 제거
                bodyRows.forEach(row => {
                    if (row.children.length > 1) { // 첫 번째 th 제외
                        row.removeChild(row.lastChild);
                    }
                });
            } else {
                alert('더 이상 열을 제거할 수 없습니다.');
            }
        }

        // 텍스트를 클립보드에 복사하는 헬퍼 함수
        function copy(text) {
            var textarea = document.createElement("textarea");
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand("copy");
            document.body.removeChild(textarea);
            alert('HTML 코드가 클립보드에 복사되었습니다!');
        }

        // 테이블의 현재 상태를 읽어 HTML 코드를 생성하고 복사하는 함수
        function copyTableHTML() {
            const tableTitle = document.getElementById('tableTitle').value || '제목 없음';
            const mealTable = document.getElementById('mealTable');

            // 새로운 div와 table 요소 생성 (스타일 클래스 적용)
            const outputDiv = document.createElement('div');
            const outputTitle = document.createElement('h4');
            outputTitle.className = 'tit2';
            outputTitle.textContent = tableTitle; // 제목 적용
            outputDiv.appendChild(outputTitle);

            const outputTableWrapper = document.createElement('div');
            outputTableWrapper.className = 'tbl_st scroll_gr mgt10';

            const outputTable = document.createElement('table');
            outputTable.className = 'output-table'; // 복사될 테이블에 적용할 클래스 추가
            outputTable.appendChild(document.createElement('caption')); // caption 빈 값으로 유지

            const outputThead = document.createElement('thead');
            const outputHeaderRow = document.createElement('tr');
            outputThead.appendChild(outputHeaderRow);

            const outputTbody = document.createElement('tbody');

            // 헤더 복사 (날짜 포함)
            const originalHeaderCells = mealTable.querySelectorAll('#hdTr th');
            originalHeaderCells.forEach((cell, index) => {
                const newTh = document.createElement('th');
                newTh.style.fontWeight = 'bold'; // CSS 클래스로 대체
                // 첫 번째 셀 ('구분')은 그대로 복사
                if (index === 0) {
                    newTh.innerHTML = cell.innerHTML; // '구분' 텍스트 복사
                     // 스타일은 CSS 클래스로 관리
                } else {
                    // 날짜 입력 필드의 값을 읽어와 텍스트로 추가
                    const inputElement = cell.querySelector('input[type="text"]');
                    newTh.textContent = inputElement ? inputElement.value : '';
                    // newTh.style.fontWeight = 'bold'; // CSS 클래스로 대체
                }
                // 기존 스타일 복사 제거

                outputHeaderRow.appendChild(newTh);
            });


            // 바디 복사 (식단 내용 포함)
            const originalBodyRows = mealTable.querySelectorAll('tbody tr');
            originalBodyRows.forEach(row => {
                const newTr = document.createElement('tr');
                newTr.style.height = '150px'; // tr의 height만 인라인 스타일로 유지

                const originalCells = row.querySelectorAll('th, td');
                originalCells.forEach((cell, index) => {
                    if (index === 0) {
                        // 첫 번째 셀 (예: 조식, 중식)은 th로 그대로 복사
                        const newTh = document.createElement('th');
                        newTh.innerHTML = cell.innerHTML; // 텍스트 복사
                        // newTh.style.fontWeight = 'bold'; // CSS 클래스로 대체
                         // 기존 스타일 복사 제거
                        newTr.appendChild(newTh);
                    } else {
                        // 나머지 셀 (식단 내용)은 td로 복사
                        const newTd = document.createElement('td');
                        const textareaElement = cell.querySelector('textarea');
                        // textarea의 값을 읽어와 <br>로 줄바꿈하여 innerHTML로 추가
                        if (textareaElement) {
                             // HTML로 변환 시 <br> 태그 사용
                             newTd.innerHTML = textareaElement.value.replace(/\n/g, '<br>');
                        } else {
                             newTd.innerHTML = '-'; // 내용이 없으면 '-' 표시 (원하는 대로 수정 가능)
                        }
                         // 기존 스타일 복사 제거
                        newTr.appendChild(newTd);
                    }
                });
                outputTbody.appendChild(newTr);
            });

            outputTable.appendChild(outputThead);
            outputTable.appendChild(outputTbody);
            outputTableWrapper.appendChild(outputTable);
            outputDiv.appendChild(outputTableWrapper);

            // 생성된 HTML 요소의 내부 HTML 코드를 가져옴
            const htmlToCopy = outputDiv.outerHTML;

            // 복사 함수 호출
            copy(htmlToCopy);
        }

        // 페이지 로드 후 기본 날짜 열 추가 (선택 사항)
        // window.onload = function() {
        //     addCol(); // 예시로 페이지 로드 시 한 개의 날짜 열 추가
        // };

    </script>
</body>

</html>
